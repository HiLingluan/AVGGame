--CS的访问接口(防止C#代码做过多的代码和各种访问，在这里做统一的封装)  后面统一转Lua后就不需要此接口了

--获取阅读女主名字
GetUserFemaleName = function()
    local userData = ServiceMgr:GetService(EServiceType.UserData)
    local name = userData:getReadFemaleName()
    if string.isNilOrEmpty(name) then
        name = "name not found";
    end
    return name
end

--显示爱心
ShowLove = function(id)
    EventMgr.Dispatcher(LuaEventKey.OPEN_LOVE, id)
end

GetLoveConfig = function(id)
    return CommonConfig:getLovePoint(id)
end

--获取换装配置
GetRoleSuitConfig = function(id)
    return CommonConfig:getRoleSuit(tonumber(id))
end

--获取换装部位是否解锁
GetRoleSuitIsUnLock = function(suitId)
    if ServiceMgr:GetService(EServiceType.ClothPool):isSuitPartUnlock(suitId) then
        return 1
    else
        return 0
    end
end

--获取立绘音量大小
GetCubismAudioVolume = function()
    return ServiceMgr:GetService(EServiceType.Setting):getCubsim()
end

--sdk 回调c#调用string ,string
SDKCallbackLua = function(funname, info)
    --LogError(funname)
    --LogError(info);
    Log("SDKCallbackLua funname："..funname)
    local serPay = ServiceMgr:GetService(EServiceType.Pay)
    if funname == "OnPaySuccessV2" then
        serPay:OnPaySuccessV2(info)
    elseif funname == "OnPayFailedV2" then
        serPay:OnPayFailedV2(info)
    elseif funname == "OnPayCanceledV2" then
        serPay:OnPayCanceledV2(info)
    elseif funname == "onConsumeSucessBack" then
        serPay:onConsumeSucessBack(info)
    elseif funname == "onConsumeFailBack" then
        serPay:onConsumeFailBack(info)
    elseif funname == "onThirdLoginFinish" then
        Log("onThirdLoginFinish")
        --print_table(info)
    elseif funname == "onThirdLoginFailed" then
        Log("onThirdLoginFailed")
        CommonTools.ShowCommonMsgTip(CommonConfig:getLanguage("lag_procedure_038"));
        EventMgr.Dispatcher(LuaEventKey.ON_THIRD_LOGIN_FAIL, info);
        --print_table(info)
    elseif funname == "LoginSuccessCallBack" then
        Log("LoginSuccessCallBack")
        local loginData = rapidjson.decode(info)
        Log(info)
        print_table(loginData)
        ServiceMgr:GetService(EServiceType.UserData):setSdkLoginData(loginData)
        EventMgr.Dispatcher(LuaEventKey.ON_THIRD_LOGIN_SUCCESS, loginData);
        --print_table(loginData)
    elseif funname == "LoginFailedCallBack" then
        Log("LoginSuccessCallBack")
        ServiceMgr:GetService(EServiceType.UserData):setSdkLoginData()
        EventMgr.Dispatcher(LuaEventKey.ON_THIRD_LOGIN_FAIL, info);
        CommonTools.ShowCommonMsgTip(CommonConfig:getLanguage("lag_procedure_038"));
        Log("ThirdLoginFailed")
        Log(info);
    elseif funname == "OnQuerySkuDetailsSuccess" then
        Log("OnQuerySkuDetailsSuccess")
        CommonConfig:QuerySkuDetailsCallBack(info)
        Log(info);
    elseif funname == "OnQuerySkuDetailsFailed" then
        Log("OnQuerySkuDetailsFailed")
        CommonConfig:QuerySkuDetailsCallBack(nil)
        Log(info);
    end
end

--获取道具或货币图标
GetPropOrCurrencyIcon = function(type, id)
    local info = CommonConfig:getPropOrCurrency(type, id)
    if info then
        return info.images
    end
    return ""
end


--Lua多语言包
GetStoryLanguage = function(key, langtype)
    return CommonConfig:GetStoryLanguage(key, langtype)
end

--显示顶层遮罩
ShowTopShadow = function(key)
    EventMgr.Dispatcher(LuaEventKey.ON_OPEN_CLOSE_TOPSHADOW, true)
    local duration = ServiceMgr:GetService(EServiceType.SystemRecord):getReadKeepTime()
    if ServiceMgr:GetService(EServiceType.DateService).isDating then
        CMSStat.mainLevelEnd(2, duration, nil, nil, nil, 3)
    else
        CMSStat.mainLevelEnd(2, duration, nil, nil, nil, 1)
    end
end
--currentParaId应该是nextparaID
RecordSelectInfo = function(selectGroupID, selectID, currentParaId)

end

--打开商城界面
OpenShopPanel = function()
    --ViewMgr:GotoPanel(EWindowType.ShopConvertPanel2)
    local loveConfig = CommonConfig.lovePointTable[10001]
    local param = {loveConfig = loveConfig}
    ViewMgr:OpenWindow(EWindowType.ReadCharge,nil,{data = param})
end

--获取玩家货币数量
GetPropCount = function(propType, propId)
    return ServiceMgr:GetService(EServiceType.UserData):getCurrencyOrPropNum(propType, propId)
end

--设置Image sprite
ImageSetSprite = function(image, propType, propId)
    local propInfo = CommonConfig:getPropOrCurrency(propType, propId)
    image.sprite = ResMgr:loadSprite(Define.EAtlasType.Prop, propInfo.images)
end

--获取下一个段落
CheckNextParaId = function(paraId)
    return ServiceMgr:GetService(EServiceType.Read):CheckNextParaId(paraId)
end


--**************************************换装************************************************
--初始化立绘字段
InitCubismProperty = function()
    local cubismService = ServiceMgr:GetService(EServiceType.CubismService)
    cubismService:initProperty()
end

--获取立绘
GetCubismByID = function(id)
    local cubismService = ServiceMgr:GetService(EServiceType.CubismService)
    return cubismService:GetCubism(id)
end
--播放立绘动作
PlayCubismMotion = function(posIndex, motion)
    local cubismService = ServiceMgr:GetService(EServiceType.CubismService)
    cubismService:PlayMotion(posIndex, motion)
end
--播放立绘表情
PlayCubismExpress = function(posIndex, express)
    local cubismService = ServiceMgr:GetService(EServiceType.CubismService)
    cubismService:PlayExpress(posIndex, express)
end
--立绘音量
UpdateCubismVol = function(vol)
    local cubismService = ServiceMgr:GetService(EServiceType.CubismService)
    cubismService:UpdateVol(vol)
end
--关闭立绘语音
CubismStopAudioByActive = function()
    local cubismService = ServiceMgr:GetService(EServiceType.CubismService)
    cubismService:StopAudioByActive()
end
--批量加载立绘
LoadCubism = function(ids, complete)
    local cubismService = ServiceMgr:GetService(EServiceType.CubismService)
    cubismService:LoadCubism(ids, complete)
end
--加载女主
LoadFemaleCubism = function(id, complete)
    local cubismService = ServiceMgr:GetService(EServiceType.CubismService)
    cubismService:LoadFemaleCubism(id, complete)
end
--隐藏所有立绘
HideAllCubism = function()
    local cubismService = ServiceMgr:GetService(EServiceType.CubismService)
    cubismService:HideAllCubism()
end
--刷新npc状态
RefreshNpcCubismState = function(list)
    local cubismService = ServiceMgr:GetService(EServiceType.CubismService)
    cubismService:RefreshNpcState(list)
end
--刷新女主状态
RefreshFemalCubismState = function(id)
    local cubismService = ServiceMgr:GetService(EServiceType.CubismService)
    cubismService:RefreshFemalState(id)
end
--设置位置并展示
SetCubismPosIndex = function(index, id)
    local cubismService = ServiceMgr:GetService(EServiceType.CubismService)
    cubismService:SetPosIndex(id, index)
end

--显示立绘
ShowCubism = function(id, info)
    local cubismService = ServiceMgr:GetService(EServiceType.CubismService)
    cubismService:ShowCubism(id, info)
end

GetCubism = function(id)
    local cubismService = ServiceMgr:GetService(EServiceType.CubismService)
    return cubismService:GetCubism(id)
end

SetCubismCloth = function(id, clothId)
    local cubismService = ServiceMgr:GetService(EServiceType.CubismService)
    return cubismService:SetCubismCloth(id, clothId)
end

--销毁
CubismDispose = function()
    local cubismService = ServiceMgr:GetService(EServiceType.CubismService)
    cubismService:Dispose()
end
--******************************************************************************************
